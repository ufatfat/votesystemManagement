(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72a9839d"],{2823:function(e,t,n){"use strict";n("5111")},5111:function(e,t,n){},a434:function(e,t,n){"use strict";var o=n("23e7"),i=n("23cb"),s=n("a691"),a=n("50c4"),c=n("7b0b"),r=n("65f0"),m=n("8418"),l=n("1dde"),u=l("splice"),g=Math.max,p=Math.min,f=9007199254740991,d="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!u},{splice:function(e,t){var n,o,l,u,h,y,b=c(this),v=a(b.length),x=i(e,v),k=arguments.length;if(0===k?n=o=0:1===k?(n=0,o=v-x):(n=k-2,o=p(g(s(t),0),v-x)),v+n-o>f)throw TypeError(d);for(l=r(b,o),u=0;u<o;u++)h=x+u,h in b&&m(l,u,b[h]);if(l.length=o,n<o){for(u=x;u<v-o;u++)h=u+o,y=u+n,h in b?b[y]=b[h]:delete b[y];for(u=v;u>v-o+n;u--)delete b[u-1]}else if(n>o)for(u=v-o;u>x;u--)h=u+o-1,y=u+n-1,h in b?b[y]=b[h]:delete b[y];for(u=0;u<n;u++)b[u+x]=arguments[u+2];return b.length=v-o+n,l}})},c740:function(e,t,n){"use strict";var o=n("23e7"),i=n("b727").findIndex,s=n("44d2"),a="findIndex",c=!0;a in[]&&Array(1)[a]((function(){c=!1})),o({target:"Array",proto:!0,forced:c},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(a)},db2e:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"margin-top":"10px"}},[n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("span",[e._v("当前开放竞赛：")]),n("el-select",{staticStyle:{width:"300px"},attrs:{size:"mini",loading:e.contestSelectorLoading},on:{change:e.openContest},model:{value:e.contestID,callback:function(t){e.contestID=t},expression:"contestID"}},[e._l(e.contests,(function(e,t){return[n("el-option",{key:t,attrs:{value:e.contest_id,label:e.contest_name}})]}))],2),n("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini"},on:{click:e.deleteContest}},[e._v("删除此竞赛")]),n("el-button",{staticStyle:{"margin-left":"60px"},attrs:{type:"primary",size:"mini"},on:{click:e.createContest}},[e._v("添加竞赛")])],1),n("fieldset",[n("legend",[e._v("竞赛设置")]),n("fieldset",[n("legend",[e._v("通用设置")]),n("div",[n("el-form",{attrs:{"label-position":"left"}},[n("el-form-item",{attrs:{label:"竞赛名称"}},[n("el-input",{attrs:{size:"mini"},on:{change:e.updateContestName},model:{value:e.contestName,callback:function(t){e.contestName=t},expression:"contestName"}})],1),n("el-form-item",{attrs:{label:"背景图片："}},[n("el-input",{attrs:{size:"mini"},on:{change:function(t){return e.updateImgUrl(t,1)}},model:{value:e.conf.common.bgImg,callback:function(t){e.$set(e.conf.common,"bgImg",t)},expression:"conf.common.bgImg"}},[n("template",{slot:"suffix"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.chooseImg(1)}}},[e._v("选择上传")])],1)],2)],1),n("el-form-item",{attrs:{label:"logo图片："}},[n("el-input",{attrs:{size:"mini"},on:{change:function(t){return e.updateImgUrl(t,2)}},model:{value:e.conf.common.logoImg,callback:function(t){e.$set(e.conf.common,"logoImg",t)},expression:"conf.common.logoImg"}},[n("template",{slot:"suffix"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.chooseImg(2)}}},[e._v("选择上传")])],1)],2)],1)],1)],1)]),n("fieldset",[n("legend",[e._v("时间设置")]),n("el-form",{attrs:{inline:""}},[n("el-form-item",{attrs:{label:"报名系统截止时间："}},[n("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",size:"mini",placeholder:"选择截止时间"},on:{change:function(t){return e.updateTimestamp(1)}},model:{value:e.registryEndDatetime,callback:function(t){e.registryEndDatetime=t},expression:"registryEndDatetime"}})],1),n("el-form-item",{attrs:{label:"上传作品开放时间："}},[n("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",size:"mini",placeholder:"选择截止时间"},on:{change:function(t){return e.updateTimestamp(2)}},model:{value:e.uploadBeginDatetime,callback:function(t){e.uploadBeginDatetime=t},expression:"uploadBeginDatetime"}})],1),n("el-form-item",{attrs:{label:"上传作品截止时间："}},[n("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",size:"mini",placeholder:"选择截止时间"},on:{change:function(t){return e.updateTimestamp(3)}},model:{value:e.uploadEndDatetime,callback:function(t){e.uploadEndDatetime=t},expression:"uploadEndDatetime"}})],1)],1)],1),n("fieldset",[n("legend",[e._v("上传设置")]),n("el-form",{attrs:{inline:""}},[n("el-form-item",{attrs:{label:"文件大小限制："}},[n("el-input",{attrs:{size:"mini"},on:{change:e.updateMaxFileSize},model:{value:e.maxFileSize,callback:function(t){e.maxFileSize=t},expression:"maxFileSize"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{slot:"append",size:"mini",placeholder:"请选择"},slot:"append",model:{value:e.unit,callback:function(t){e.unit=t},expression:"unit"}},[e._l(e.units,(function(e,t){return[n("el-option",{key:t,attrs:{value:t,label:e}})]}))],2)],1)],1),n("el-form-item",{attrs:{label:"图纸数量限制："}},[n("el-input-number",{attrs:{size:"mini","controls-position":"right",precision:0,step:1},on:{change:e.updateMaxImageNum},model:{value:e.maxImageNum,callback:function(t){e.maxImageNum=t},expression:"maxImageNum"}})],1),n("el-form-item",{attrs:{label:"赛点："}},[n("el-input",{attrs:{size:"mini"},model:{value:e.newWorkGroup,callback:function(t){e.newWorkGroup=t},expression:"newWorkGroup"}},[n("el-select",{staticStyle:{width:"200px"},attrs:{slot:"prepend",size:"mini",placeholder:"在右边增加赛点"},slot:"prepend",model:{value:e.workGroup,callback:function(t){e.workGroup=t},expression:"workGroup"}},[e._l(e.workGroups,(function(t,o){return[n("el-option",{key:o+"workgroups",attrs:{value:o,label:t}},[n("span",{staticStyle:{float:"left"}},[e._v(e._s(t))]),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.delWorkGroup(o)}}},[e._v("删除")])],1)])]}))],2),n("el-button",{staticStyle:{width:"100px"},attrs:{slot:"append",size:"mini",type:"primary"},on:{click:e.addWorkGroup},slot:"append"},[e._v("添加赛点")])],1)],1)],1)],1)]),n("input",{staticStyle:{display:"none"},attrs:{id:"file1",type:"file",accept:"image/png, image/jpeg"},on:{change:function(t){return e.updateImg(1)}}}),n("input",{staticStyle:{display:"none"},attrs:{id:"file2",type:"file",accept:"image/png, image/jpeg"},on:{change:function(t){return e.updateImg(2)}}})])},i=[],s=n("5530"),a=(n("159b"),n("a434"),n("c740"),n("fb6a"),n("b0c0"),n("2f62")),c=n("f8c8"),r={name:"General",data:function(){return{contestSelectorLoading:!1,contests:[],conf:{pages:{proc:"",topic:"",joinUs:"",aboutUs:"",rewards:"",contactUs:""},common:{bgImg:"",logoImg:"",themeColor:{deep:"",light:"",deepest:"",lightest:""}},system:{uploadEndTimestamp:0,registryEndTimestamp:0,uploadBeginTimestamp:0},uploadRes:{workGroups:[],maxFileSize:0,maxImageNum:0},enableMarking:!1},maxFileSize:0,maxImageNum:0,unit:0,units:["Bytes","KiB","MiB","GiB"],contestName:"",contestID:0,registryEndDatetime:"",uploadBeginDatetime:"",uploadEndDatetime:"",workGroups:[],workGroup:0,newWorkGroup:""}},computed:Object(s["a"])({},Object(a["b"])(["config"])),mounted:function(){this.mount()},methods:Object(s["a"])(Object(s["a"])({mount:function(){var e=this;this.contestSelectorLoading=!0,Object(c["h"])().then((function(t){var n=t.data;n.forEach((function(t){t.is_open&&(e.contestID=t.contest_id)})),e.contests=n,e.conf=e.config.config,e.contestName=e.config.contestName,e.contestSelectorLoading=!1,e.updateDatetimes();var o=e.config.config.uploadRes.maxFileSize,i=0;while(o)o>>=10,i++;e.unit=i-1,e.maxFileSize=e.config.config.uploadRes.maxFileSize>>10*(i-1),e.maxImageNum=e.config.config.uploadRes.maxImageNum,e.workGroups=e.config.config.uploadRes.workGroups,console.log(e.conf)}))},deleteContest:function(){var e=this;this.$confirm("即将删除当前竞赛，此操作不可逆，确认？",{confirmButtonText:"确认",cancelButtonText:"取消"}).then((function(){var t={contest_id:e.contestID};Object(c["d"])(t).then((function(){e.$message({type:"success",message:"删除成功"}),e.contests.splice(e.contests.findIndex((function(t){return t.contest_id===e.contestID})),1),e.contestID=e.contests[e.contests.length-1].contest_id,e.openContest(e.contestID)})).catch((function(t){e.$message({type:"error",message:"删除失败，原因："+t.response.data.msg})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},createContest:function(){var e=this,t={pages:{proc:"",topic:"",joinUs:"",aboutUs:"",rewards:"",contactUs:""},common:{bgImg:"",logoImg:"",themeColor:{deep:"",light:"",deepest:"",lightest:""}},system:{uploadEndTimestamp:0,registryEndTimestamp:0,uploadBeginTimestamp:0},uploadRes:{workGroups:[],maxFileSize:0,maxImageNum:0},enableMarking:!1},n={config:JSON.stringify(t)};Object(c["a"])(n).then((function(){e.$message({type:"success",message:"添加成功"}),e.mount()})).catch((function(t){e.$message({type:"error",message:"添加失败，原因："+t.response.data.msg})}))},delWorkGroup:function(e){var t=this,n=this.config.config;n.uploadRes.workGroups.splice(e,1);var o={contest_id:this.contestID,config:JSON.stringify(n)};Object(c["t"])(o).then((function(){t.$message({type:"success",message:"删除成功"});var o=t.config;o.config=n,t.updateConfig(o),t.workGroups.splice(e,1)})).catch((function(e){t.$message({type:"error",message:"删除失败，报错："+e.response.data.msg})}))},addWorkGroup:function(){var e=this,t=this.config.config;t.uploadRes.workGroups.push(this.newWorkGroup);var n={contest_id:this.contestID,config:JSON.stringify(t)};Object(c["t"])(n).then((function(){e.$message({type:"success",message:"添加成功"});var n=e.config;n.config=t,e.updateConfig(t),e.workGroups.push(e.newWorkGroup),e.newWorkGroup=""})).catch((function(t){e.$message({type:"error",message:"添加失败，报错："+t.response.data.msg}),e.newWorkGroup=""}))}},Object(a["c"])(["updateConfig"])),{},{updateDatetimes:function(){this.registryEndDatetime=this.formatDatetime(this.config.config.system.registryEndTimestamp),this.uploadBeginDatetime=this.formatDatetime(this.config.config.system.uploadBeginTimestamp),this.uploadEndDatetime=this.formatDatetime(this.config.config.system.uploadEndTimestamp)},formatDatetime:function(e){if(!e)return"";var t=new Date(1e3*e),n=function(e){return e<10?"0"+e:e},o=t.getFullYear(),i=n(t.getMonth()+1),s=n(t.getDate()),a=n(t.getHours()),c=n(t.getMinutes()),r=n(t.getSeconds());return o+"-"+i+"-"+s+" "+a+":"+c+":"+r},chooseImg:function(e){var t=document.querySelector("#file"+e);t.click()},updateImg:function(e){var t=this,n=new FormData,o=document.querySelector("#file"+e),i=o.files[0];n.append("image",i),n.append("suffix",i.name.slice(i.name.lastIndexOf("."))),Object(c["w"])(n).then((function(n){var o=t.config.config;1===e?o.common.bgImg=n.data.url:o.common.logoImg=n.data.url;var i={contest_id:t.contestID,config:JSON.stringify(o)};Object(c["t"])(i).then((function(){var e=t.config;e.config=o,t.updateConfig(e),t.$message({type:"success",message:"上传成功"})})).catch((function(e){t.$message({type:"error",message:"上传失败，报错："+e.response.data.msg})}))})).catch((function(e){t.$message({type:"error",message:"上传失败，报错："+e.response.data.msg})}))},updateImgUrl:function(e,t){var n=this,o=this.config.config;1===t?o.common.bgImg=e:o.common.logoImg=e;var i={contest_id:this.contestID,config:JSON.stringify(o)};Object(c["t"])(i).then((function(){var e=n.config;e.config=o,n.updateConfig(e),n.$message({type:"success",message:"上传成功"})})).catch((function(e){n.$message({type:"error",message:"上传失败，报错："+e.response.data.msg})}))},openContest:function(e){var t=this;this.contestSelectorLoading=!0;var n={contest_id:e,is_open:!0};Object(c["t"])(n).then((function(){t.$message({type:"success",message:"更新成功！"}),t.axios.defaults.headers["ContestID"]=t.contestID,Object(c["g"])().then((function(e){var n=e.data;n.config=JSON.parse(n.config),t.updateConfig(n),t.updateDatetimes(),t.contestSelectorLoading=!1,t.mount()})).catch((function(){t.contestSelectorLoading=!1}))})).catch((function(){t.$message({type:"error",message:"更新失败，请联系管理员"}),t.contestSelectorLoading=!1}))},updateTimestamp:function(e){var t=this,n=this.config.config;switch(e){case 1:n.system.registryEndTimestamp=new Date(this.registryEndDatetime).getTime()/1e3;break;case 2:n.system.registryEndTimestamp=new Date(this.uploadBeginDatetime).getTime()/1e3;break;case 3:n.system.registryEndTimestamp=new Date(this.uploadEndDatetime).getTime()/1e3;break}var o={contest_id:this.contestID,config:JSON.stringify(n)};Object(c["t"])(o).then((function(){t.updateConfig(n),t.$message({type:"success",message:"更新成功"});var e=t.config;e.config=n,t.updateConfig(e)})).catch((function(e){t.$message({type:"error",message:"更新失败，报错："+e.response.data.msg})}))},updateMaxFileSize:function(){var e=this,t=this.config.config;t.uploadRes.maxFileSize=this.maxFileSize<<10*this.unit;var n={contest_id:this.contestID,config:JSON.stringify(t)};Object(c["t"])(n).then((function(){e.$message({type:"success",message:"更新成功"});var n=e.config;n.config=t,e.updateConfig(n)})).catch((function(t){e.$message({type:"error",message:"更新失败，报错："+t.response.data.msg})}))},updateMaxImageNum:function(){var e=this,t=this.config.config;t.uploadRes.maxImageNum=this.maxImageNum;var n={contest_id:this.contestID,config:JSON.stringify(t)};Object(c["t"])(n).then((function(){e.$message({type:"success",message:"更新成功"});var n=e.config;n.config=t,e.updateConfig(n)})).catch((function(t){e.$message({type:"error",message:"更新失败，报错："+t.response.data.msg})}))},updateContestName:function(e){var t={contest_id:this.contestID,contest_name:e};Object(c["t"])(t).then()}})},m=r,l=(n("2823"),n("2877")),u=Object(l["a"])(m,o,i,!1,null,"01147dee",null);t["default"]=u.exports},fb6a:function(e,t,n){"use strict";var o=n("23e7"),i=n("861d"),s=n("e8b5"),a=n("23cb"),c=n("50c4"),r=n("fc6a"),m=n("8418"),l=n("b622"),u=n("1dde"),g=u("slice"),p=l("species"),f=[].slice,d=Math.max;o({target:"Array",proto:!0,forced:!g},{slice:function(e,t){var n,o,l,u=r(this),g=c(u.length),h=a(e,g),y=a(void 0===t?g:t,g);if(s(u)&&(n=u.constructor,"function"!=typeof n||n!==Array&&!s(n.prototype)?i(n)&&(n=n[p],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return f.call(u,h,y);for(o=new(void 0===n?Array:n)(d(y-h,0)),l=0;h<y;h++,l++)h in u&&m(o,l,u[h]);return o.length=l,o}})}}]);
//# sourceMappingURL=chunk-72a9839d.9db3f7b8.js.map