(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-934132ac"],{"04d1":function(e,t,n){var o=n("342f"),i=o.match(/firefox\/(\d+)/i);e.exports=!!i&&+i[1]},2532:function(e,t,n){"use strict";var o=n("23e7"),i=n("5a34"),a=n("1d80"),r=n("577e"),c=n("ab13");o({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~r(a(this)).indexOf(r(i(e)),arguments.length>1?arguments[1]:void 0)}})},"379d":function(e,t,n){},"44e7":function(e,t,n){var o=n("861d"),i=n("c6b6"),a=n("b622"),r=a("match");e.exports=function(e){var t;return o(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==i(e))}},"4e82":function(e,t,n){"use strict";var o=n("23e7"),i=n("1c0b"),a=n("7b0b"),r=n("50c4"),c=n("577e"),s=n("d039"),u=n("addb"),d=n("a640"),l=n("04d1"),f=n("d998"),p=n("2d00"),h=n("512ce"),m=[],g=m.sort,v=s((function(){m.sort(void 0)})),x=s((function(){m.sort(null)})),b=d("sort"),y=!s((function(){if(p)return p<70;if(!(l&&l>3)){if(f)return!0;if(h)return h<603;var e,t,n,o,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)m.push({k:t+o,v:n})}for(m.sort((function(e,t){return t.v-e.v})),o=0;o<m.length;o++)t=m[o].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})),_=v||!x||!b||!y,k=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:c(t)>c(n)?1:-1}};o({target:"Array",proto:!0,forced:_},{sort:function(e){void 0!==e&&i(e);var t=a(this);if(y)return void 0===e?g.call(t):g.call(t,e);var n,o,c=[],s=r(t.length);for(o=0;o<s;o++)o in t&&c.push(t[o]);c=u(c,k(e)),n=c.length,o=0;while(o<n)t[o]=c[o++];while(o<s)delete t[o++];return t}})},"512ce":function(e,t,n){var o=n("342f"),i=o.match(/AppleWebKit\/(\d+)\./);e.exports=!!i&&+i[1]},"585b":function(e,t,n){"use strict";n("379d")},"5a34":function(e,t,n){var o=n("44e7");e.exports=function(e){if(o(e))throw TypeError("The method doesn't accept regular expressions");return e}},a434:function(e,t,n){"use strict";var o=n("23e7"),i=n("23cb"),a=n("a691"),r=n("50c4"),c=n("7b0b"),s=n("65f0"),u=n("8418"),d=n("1dde"),l=d("splice"),f=Math.max,p=Math.min,h=9007199254740991,m="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!l},{splice:function(e,t){var n,o,d,l,g,v,x=c(this),b=r(x.length),y=i(e,b),_=arguments.length;if(0===_?n=o=0:1===_?(n=0,o=b-y):(n=_-2,o=p(f(a(t),0),b-y)),b+n-o>h)throw TypeError(m);for(d=s(x,o),l=0;l<o;l++)g=y+l,g in x&&u(d,l,x[g]);if(d.length=o,n<o){for(l=y;l<b-o;l++)g=l+o,v=l+n,g in x?x[v]=x[g]:delete x[v];for(l=b;l>b-o+n;l--)delete x[l-1]}else if(n>o)for(l=b-o;l>y;l--)g=l+o-1,v=l+n-1,g in x?x[v]=x[g]:delete x[v];for(l=0;l<n;l++)x[l+y]=arguments[l+2];return x.length=b-o+n,d}})},ab13:function(e,t,n){var o=n("b622"),i=o("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(o){}}return!1}},addb:function(e,t){var n=Math.floor,o=function(e,t){var r=e.length,c=n(r/2);return r<8?i(e,t):a(o(e.slice(0,c),t),o(e.slice(c),t),t)},i=function(e,t){var n,o,i=e.length,a=1;while(a<i){o=a,n=e[a];while(o&&t(e[o-1],n)>0)e[o]=e[--o];o!==a++&&(e[o]=n)}return e},a=function(e,t,n){var o=e.length,i=t.length,a=0,r=0,c=[];while(a<o||r<i)a<o&&r<i?c.push(n(e[a],t[r])<=0?e[a++]:t[r++]):c.push(a<o?e[a++]:t[r++]);return c};e.exports=o},c740:function(e,t,n){"use strict";var o=n("23e7"),i=n("b727").findIndex,a=n("44d2"),r="findIndex",c=!0;r in[]&&Array(1)[r]((function(){c=!1})),o({target:"Array",proto:!0,forced:c},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a(r)},caad:function(e,t,n){"use strict";var o=n("23e7"),i=n("4d64").includes,a=n("44d2");o({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},d998:function(e,t,n){var o=n("342f");e.exports=/MSIE|Trident/.test(o)},d9e4:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("RoundTable",{staticStyle:{width:"300px"}}),n("div",{staticStyle:{width:"calc(100% - 320px)"}},[n("div",{staticStyle:{display:"flex","justify-content":"space-evenly","align-items":"center"}},[n("span",[e._v("平票："+e._s(e.promotionNum))]),n("span",[e._v("已晋级："+e._s(e.promotedNum))]),n("span",[e._v("可晋级："+e._s(e.roundInfo[e.currentRoundIdx-1].promotion_num))]),n("span",[e._v("已选中："+e._s(e.votedWorks.length))]),e.promotionNum>0?[n("div",[n("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",size:"mini",placeholder:"选择截止时间"},on:{change:e.printDatetime},model:{value:e.endDateTime,callback:function(t){e.endDateTime=t},expression:"endDateTime"}}),e._v("  "),n("el-button",{attrs:{size:"mini",type:"primary",disabled:this.judgeRevoteStatus,loading:e.loading.judgeRevote},on:{click:e.openJudgeRevote}},[e._v("开启评审端重投")])],1)]:e._e(),e.currentRoundIdx<e.roundInfo.length?[n("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.openNextRound}},[e._v("开放下一轮次")])]:[n("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.closeJudge}},[e._v("结束线上评审")])]],2),n("div",{staticClass:"workContainer",staticStyle:{"flex-direction":"column","margin-top":"10px"}},[e._l(e.sliceList(e.promotionInfo,5),(function(t,o){return[n("div",{key:o,staticClass:"workRow",staticStyle:{width:"100%",display:"flex","justify-content":"space-evenly"}},[e._l(t,(function(t,o){return[n("div",{key:o,staticClass:"workBox",class:t.checked?"workBoxChecked":"",on:{click:function(n){return e.workBoxClickHandler(t)}}},[n("div",{staticClass:"imgNCheckBox"},[n("div",[n("el-checkbox",{attrs:{disabled:e.promotionNum===e.votedWorks.length&&!t.checked},on:{click:function(e){if(e.target!==e.currentTarget)return null;e.preventDefault()}},model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"item.checked"}})],1),n("div",{staticStyle:{width:"148.5px",height:"210px"}},[n("el-image",{attrs:{src:t.img_list[0],lazy:""}})],1)]),n("div",{staticStyle:{"margin-top":"10px",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[n("span",{staticClass:"workName"},[e._v(e._s(t.user_idx)+" - "+e._s(t.work_name))])])])]}))],2)]}))],2),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("el-pagination",{attrs:{layout:"total, sizes","page-size":e.num,total:e.promotionNum,"page-sizes":[10,20]},on:{"size-change":e.sizeChangeHandler,"update:pageSize":function(t){e.num=t},"update:page-size":function(t){e.num=t},"update:total":function(t){e.promotionNum=t}}}),n("el-pagination",{attrs:{layout:"prev, pager, next, jumper","current-page":e.page,"page-size":e.num,total:e.promotionNum,"page-sizes":[10,20]},on:{"current-change":e.pageChangeHandler,"update:pageSize":function(t){e.num=t},"update:page-size":function(t){e.num=t},"update:total":function(t){e.promotionNum=t}}})],1)])],1)},i=[],a=(n("a434"),n("c740"),n("4e82"),n("159b"),n("caad"),n("2532"),n("fb6a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"20px"}},[n("span",[e._v(" 当前轮次："+e._s(e.currentRoundIdx)+" ")]),n("el-select",{attrs:{size:"small"},on:{change:e.changeHandler},model:{value:e.selectedRoundID,callback:function(t){e.selectedRoundID=t},expression:"selectedRoundID"}},e._l(e.roundInfo,(function(t){return n("el-option",{key:t.round_id,attrs:{label:t.round_desc,value:t.round_id,disabled:t.round_index>e.currentRoundIdx}})})),1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.roundData}},[n("el-table-column",{attrs:{prop:"name",label:"评委姓名",align:"center"}}),n("el-table-column",{attrs:{label:"是否已提交结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_done?[e._v(" 已提交 ")]:[e._v(" 未提交 ")]]}}])})],1)],1)}),r=[],c=n("f8c8"),s={name:"VoteStatTable",data:function(){return{currentRoundIdx:0,selectedRoundID:0,roundData:[],roundInfo:[],tableLoading:!1}},mounted:function(){var e=this;Object(c["k"])().then((function(t){e.currentRoundIdx=t.data.current_round_idx,e.selectedRoundID=t.data.current_round_id,e.roundInfo=t.data.round_info,e.getData()}))},methods:{changeHandler:function(){this.getData()},getData:function(){var e=this;this.tableLoading=!0;var t={round_id:this.selectedRoundID};Object(c["j"])(t).then((function(t){e.roundData=t.data,e.tableLoading=!1}))}}},u=s,d=n("2877"),l=Object(d["a"])(u,a,r,!1,null,"7bba30ba",null),f=l.exports,p={name:"RoundInfo",components:{RoundTable:f},data:function(){return{roundInfo:[],currentRoundIdx:0,promotionNum:0,promotedNum:0,page:1,num:10,votedWorks:[],voteInfo:[],promotionInfo:[],judgeRevoteStatus:!1,endDateTime:"",endTimestamp:0,loading:{judgeRevote:!1}}},mounted:function(){var e=this;Object(c["k"])().then((function(t){e.currentRoundIdx=t.data.current_round_idx,e.roundInfo=t.data.round_info})),Object(c["h"])().then((function(t){e.judgeRevoteStatus=t.data.msg})),this.getData()},computed:{sliceList:function(){return function(e,t){var n=0,o=[];if(void 0!==e)for(var i=0;i<e.length;i++)n=parseInt(i/t),o.length<=n&&o.push([]),o[n].push(e[i]);return o}}},methods:{printDatetime:function(){this.endTimestamp=new Date(this.endDateTime).getTime()/1e3},pageChangeHandler:function(e){this.page=e,this.getData()},sizeChangeHandler:function(e){this.num=e,this.getData()},workBoxClickHandler:function(e){e.checked=!e.checked,this.checkChangeHandler(e)},openJudgeRevote:function(){var e=this;this.loading.judgeRevote=!0;var t={end_timestamp:this.endTimestamp};Object(c["m"])(t).then((function(){e.$message({type:"success",message:"评审端重投已开启"}),e.judgeRevoteStatus=!0,e.loading.judgeRevote=!1})).catch((function(){e.$message({type:"error",message:"开启失败，请联系开发者"}),e.loading.judgeRevote=!1}))},checkChangeHandler:function(e){var t=this.voteInfo,n=this.votedWorks;e.checked?(t.push(e),t.sort((function(e,t){return e.user_id-t.user_id})),n.push(e.user_id),n.sort((function(e,t){return e-t}))):(t.splice(t.findIndex((function(t){return t.user_id===e.user_id})),1),n.splice(n.indexOf(e.user_id),1))},openNextRound:function(){var e=this;this.votedWorks.length===this.roundInfo[this.currentRoundIdx].promotion_num?this.$confirm("当前可晋级作品数超过本轮评审应该晋级的作品数，且没有人工平票重投。若开启下一轮次则当前所有可晋级作品均晋级到下一轮，且本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，请确认。","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={voted_works:e.votedWorks};Object(c["n"])(t).then((function(){e.$message({type:"success",message:"操作成功！"}),location.reload()}))})).catch((function(){e.$message({type:"error",message:"操作失败！"})})):this.votedWorks.length<this.roundInfo[this.currentRoundIdx].promotion_num?this.$confirm("当前平票重投选中作品数少于本轮评审应该晋级的作品数。若开启下一轮次则仅被选中的作品可晋级下一轮，且本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，请确认。","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={voted_works:e.votedWorks};Object(c["n"])(t).then((function(){e.$message({type:"success",message:"操作成功！"}),setTimeout((function(){location.reload()}),1e3)}))})).catch((function(){e.$message({type:"error",message:"操作失败！"})})):this.$confirm("即将开放下一轮次，本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，请确认。","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["n"])().then((function(){e.$message({type:"success",message:"操作成功！"}),setTimeout((function(){location.reload()}),1e3)}))})).catch((function(){e.$message({type:"error",message:"操作失败！"})}))},closeJudge:function(){var e=this;this.$confirm("即将关闭线上评审，本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，确认？","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["n"])().then((function(){e.$message({type:"success",message:"操作成功！"}),setTimeout((function(){location.reload()}),1e3)}))})).catch((function(){e.$message({type:"error",message:"操作失败！"})}))},getData:function(){var e=this,t={page:this.page,num:this.num};Object(c["i"])(t).then((function(t){e.promotionNum=t.data.total,e.promotedNum=t.data.promoted_num-t.data.total;var n=t.data.promotion_info;n.forEach((function(t){var n;e.votedWorks.includes(t.user_id)?t.checked=!0:t.checked=!1,""===t.work_name&&(t.work_name="测试"),(null===(n=!t.img_list)||void 0===n||n)&&(t.img_list=["https://ivillages-images.oss-cn-qingdao.aliyuncs.com/1/static/imgs/test.png"]),t.img_list.forEach((function(e,n){t.img_list[n]=e.slice(0,e.lastIndexOf("."))+"_compressed"+e.slice(e.lastIndexOf("."),e.length)}))})),e.promotionInfo=n}))}}},h=p,m=(n("585b"),Object(d["a"])(h,o,i,!1,null,"170e7b38",null));t["default"]=m.exports},fb6a:function(e,t,n){"use strict";var o=n("23e7"),i=n("861d"),a=n("e8b5"),r=n("23cb"),c=n("50c4"),s=n("fc6a"),u=n("8418"),d=n("b622"),l=n("1dde"),f=l("slice"),p=d("species"),h=[].slice,m=Math.max;o({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var n,o,d,l=s(this),f=c(l.length),g=r(e,f),v=r(void 0===t?f:t,f);if(a(l)&&(n=l.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?i(n)&&(n=n[p],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return h.call(l,g,v);for(o=new(void 0===n?Array:n)(m(v-g,0)),d=0;g<v;g++,d++)g in l&&u(o,d,l[g]);return o.length=d,o}})}}]);
//# sourceMappingURL=chunk-934132ac.dc03b68c.js.map