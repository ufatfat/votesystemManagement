(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6809aa11"],{"04d1":function(t,e,n){var o=n("342f"),i=o.match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},2532:function(t,e,n){"use strict";var o=n("23e7"),i=n("5a34"),r=n("1d80"),a=n("577e"),c=n("ab13");o({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~a(r(this)).indexOf(a(i(t)),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,n){var o=n("861d"),i=n("c6b6"),r=n("b622"),a=r("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==i(t))}},"4e82":function(t,e,n){"use strict";var o=n("23e7"),i=n("1c0b"),r=n("7b0b"),a=n("50c4"),c=n("577e"),s=n("d039"),u=n("addb"),d=n("a640"),l=n("04d1"),f=n("d998"),h=n("2d00"),p=n("512ce"),m=[],g=m.sort,v=s((function(){m.sort(void 0)})),x=s((function(){m.sort(null)})),_=d("sort"),b=!s((function(){if(h)return h<70;if(!(l&&l>3)){if(f)return!0;if(p)return p<603;var t,e,n,o,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)m.push({k:e+o,v:n})}for(m.sort((function(t,e){return e.v-t.v})),o=0;o<m.length;o++)e=m[o].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}})),k=v||!x||!_||!b,y=function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:c(e)>c(n)?1:-1}};o({target:"Array",proto:!0,forced:k},{sort:function(t){void 0!==t&&i(t);var e=r(this);if(b)return void 0===t?g.call(e):g.call(e,t);var n,o,c=[],s=a(e.length);for(o=0;o<s;o++)o in e&&c.push(e[o]);c=u(c,y(t)),n=c.length,o=0;while(o<n)e[o]=c[o++];while(o<s)delete e[o++];return e}})},"512ce":function(t,e,n){var o=n("342f"),i=o.match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},"5a34":function(t,e,n){var o=n("44e7");t.exports=function(t){if(o(t))throw TypeError("The method doesn't accept regular expressions");return t}},"7f95":function(t,e,n){},"8a6f":function(t,e,n){"use strict";n("7f95")},a434:function(t,e,n){"use strict";var o=n("23e7"),i=n("23cb"),r=n("a691"),a=n("50c4"),c=n("7b0b"),s=n("65f0"),u=n("8418"),d=n("1dde"),l=d("splice"),f=Math.max,h=Math.min,p=9007199254740991,m="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!l},{splice:function(t,e){var n,o,d,l,g,v,x=c(this),_=a(x.length),b=i(t,_),k=arguments.length;if(0===k?n=o=0:1===k?(n=0,o=_-b):(n=k-2,o=h(f(r(e),0),_-b)),_+n-o>p)throw TypeError(m);for(d=s(x,o),l=0;l<o;l++)g=b+l,g in x&&u(d,l,x[g]);if(d.length=o,n<o){for(l=b;l<_-o;l++)g=l+o,v=l+n,g in x?x[v]=x[g]:delete x[v];for(l=_;l>_-o+n;l--)delete x[l-1]}else if(n>o)for(l=_-o;l>b;l--)g=l+o-1,v=l+n-1,g in x?x[v]=x[g]:delete x[v];for(l=0;l<n;l++)x[l+b]=arguments[l+2];return x.length=_-o+n,d}})},ab13:function(t,e,n){var o=n("b622"),i=o("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(o){}}return!1}},addb:function(t,e){var n=Math.floor,o=function(t,e){var a=t.length,c=n(a/2);return a<8?i(t,e):r(o(t.slice(0,c),e),o(t.slice(c),e),e)},i=function(t,e){var n,o,i=t.length,r=1;while(r<i){o=r,n=t[r];while(o&&e(t[o-1],n)>0)t[o]=t[--o];o!==r++&&(t[o]=n)}return t},r=function(t,e,n){var o=t.length,i=e.length,r=0,a=0,c=[];while(r<o||a<i)r<o&&a<i?c.push(n(t[r],e[a])<=0?t[r++]:e[a++]):c.push(r<o?t[r++]:e[a++]);return c};t.exports=o},c740:function(t,e,n){"use strict";var o=n("23e7"),i=n("b727").findIndex,r=n("44d2"),a="findIndex",c=!0;a in[]&&Array(1)[a]((function(){c=!1})),o({target:"Array",proto:!0,forced:c},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(a)},caad:function(t,e,n){"use strict";var o=n("23e7"),i=n("4d64").includes,r=n("44d2");o({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},d998:function(t,e,n){var o=n("342f");t.exports=/MSIE|Trident/.test(o)},d9e4:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("RoundTable",{staticStyle:{width:"300px"}}),n("div",{staticStyle:{width:"calc(100% - 320px)"}},[n("div",{staticStyle:{display:"flex","justify-content":"space-evenly","align-items":"center"}},[n("span",[t._v("平票："+t._s(t.promotionNum))]),n("span",[t._v("已晋级："+t._s(t.promotedNum))]),n("span",[t._v("可晋级："+t._s(t.roundInfo[t.currentRoundIdx-1].promotion_num))]),n("span",[t._v("已选中："+t._s(t.votedWorks.length))]),t.promotionNum>0?[n("div",{staticStyle:{display:"flex","align-items":"center"}},[t._v(" 评审端重投： "),n("el-input-number",{attrs:{size:"mini",controls:"","controls-position":"right",min:0,max:t.promotionNum,"step-strictly":!0,step:1,label:"选择数量"},model:{value:t.judgeCheckNum,callback:function(e){t.judgeCheckNum=e},expression:"judgeCheckNum"}}),t._v("  "),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.openJudgeRevote}},[t._v("开启")])],1)]:t._e(),t.currentRoundIdx<t.roundInfo.length?[n("el-button",{attrs:{size:"small",type:"warning"},on:{click:t.openNextRound}},[t._v("开放下一轮次")])]:[n("el-button",{attrs:{size:"small",type:"danger"},on:{click:t.closeJudge}},[t._v("结束线上评审")])]],2),n("div",{staticClass:"workContainer",staticStyle:{"flex-direction":"column","margin-top":"10px"}},[t._l(t.sliceList(t.promotionInfo,5),(function(e,o){return[n("div",{key:o,staticClass:"workRow",staticStyle:{width:"100%",display:"flex","justify-content":"space-evenly"}},[t._l(e,(function(e,o){return[n("div",{key:o,staticClass:"workBox",class:e.checked?"workBoxChecked":"",on:{click:function(n){return t.workBoxClickHandler(e)}}},[n("div",{staticClass:"imgNCheckBox"},[n("div",[n("el-checkbox",{attrs:{disabled:t.promotionNum===t.votedWorks.length&&!e.checked},on:{click:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()}},model:{value:e.checked,callback:function(n){t.$set(e,"checked",n)},expression:"item.checked"}})],1),n("div",{staticStyle:{width:"148.5px",height:"210px"}},[n("el-image",{attrs:{src:e.img_list[0],lazy:""}})],1)]),n("div",{staticStyle:{"margin-top":"10px",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[n("span",{staticClass:"workName"},[t._v(t._s(e.user_idx)+" - "+t._s(e.work_name))])])])]}))],2)]}))],2),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("el-pagination",{attrs:{layout:"total, sizes","page-size":t.num,total:t.promotionNum,"page-sizes":[10,20]},on:{"size-change":t.sizeChangeHandler,"update:pageSize":function(e){t.num=e},"update:page-size":function(e){t.num=e},"update:total":function(e){t.promotionNum=e}}}),n("el-pagination",{attrs:{layout:"prev, pager, next, jumper","current-page":t.page,"page-size":t.num,total:t.promotionNum,"page-sizes":[10,20]},on:{"current-change":t.pageChangeHandler,"update:pageSize":function(e){t.num=e},"update:page-size":function(e){t.num=e},"update:total":function(e){t.promotionNum=e}}})],1)])],1)},i=[],r=(n("a434"),n("c740"),n("4e82"),n("159b"),n("caad"),n("2532"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"20px"}},[n("span",[t._v(" 当前轮次："+t._s(t.currentRoundIdx)+" ")]),n("el-select",{attrs:{size:"small"},on:{change:t.changeHandler},model:{value:t.selectedRoundID,callback:function(e){t.selectedRoundID=e},expression:"selectedRoundID"}},t._l(t.roundInfo,(function(e){return n("el-option",{key:e.round_id,attrs:{label:e.round_desc,value:e.round_id,disabled:e.round_index>t.currentRoundIdx}})})),1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.roundData}},[n("el-table-column",{attrs:{prop:"name",label:"评委姓名",align:"center"}}),n("el-table-column",{attrs:{label:"是否已提交结果",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.is_done?[t._v(" 已提交 ")]:[t._v(" 未提交 ")]]}}])})],1)],1)}),a=[],c=n("f8c8"),s={name:"VoteStatTable",data:function(){return{currentRoundIdx:0,selectedRoundID:0,roundData:[],roundInfo:[],tableLoading:!1}},mounted:function(){var t=this;Object(c["j"])().then((function(e){t.currentRoundIdx=e.data.current_round_idx,t.selectedRoundID=e.data.current_round_id,t.roundInfo=e.data.round_info,t.getData()}))},methods:{changeHandler:function(){this.getData()},getData:function(){var t=this;this.tableLoading=!0;var e={round_id:this.selectedRoundID};Object(c["i"])(e).then((function(e){t.roundData=e.data,t.tableLoading=!1}))}}},u=s,d=n("2877"),l=Object(d["a"])(u,r,a,!1,null,"7bba30ba",null),f=l.exports,h={name:"RoundInfo",components:{RoundTable:f},data:function(){return{roundInfo:[],currentRoundIdx:0,promotionNum:0,promotedNum:0,page:1,num:10,votedWorks:[],voteInfo:[],promotionInfo:[],judgeCheckNum:0}},mounted:function(){var t=this;Object(c["j"])().then((function(e){t.currentRoundIdx=e.data.current_round_idx,t.roundInfo=e.data.round_info})),this.getData()},computed:{sliceList:function(){return function(t,e){var n=0,o=[];if(void 0!==t)for(var i=0;i<t.length;i++)n=parseInt(i/e),o.length<=n&&o.push([]),o[n].push(t[i]);return o}}},methods:{pageChangeHandler:function(t){this.page=t,this.getData()},sizeChangeHandler:function(t){this.num=t,this.getData()},workBoxClickHandler:function(t){t.checked=!t.checked,this.checkChangeHandler(t)},openJudgeRevote:function(){var t={revote_num:this.judgeCheckNum};Object(c["l"])(t).then((function(t){console.log(t)}))},checkChangeHandler:function(t){var e=this.voteInfo,n=this.votedWorks;t.checked?(e.push(t),e.sort((function(t,e){return t.user_id-e.user_id})),n.push(t.user_id),n.sort((function(t,e){return t-e}))):(e.splice(e.findIndex((function(e){return e.user_id===t.user_id})),1),n.splice(n.indexOf(t.user_id),1))},openNextRound:function(){var t=this;this.votedWorks.length===this.roundInfo[this.currentRoundIdx].promotion_num?this.$confirm("当前可晋级作品数超过本轮评审应该晋级的作品数，且没有人工平票重投。若开启下一轮次则当前所有可晋级作品均晋级到下一轮，且本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，请确认。","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var e={voted_works:t.votedWorks};Object(c["m"])(e).then((function(){t.$message({type:"success",message:"操作成功！"}),location.reload()}))})).catch((function(){t.$message({type:"error",message:"操作失败！"})})):this.votedWorks.length<this.roundInfo[this.currentRoundIdx].promotion_num?this.$confirm("当前平票重投选中作品数少于本轮评审应该晋级的作品数。若开启下一轮次则仅被选中的作品可晋级下一轮，且本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，请确认。","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var e={voted_works:t.votedWorks};Object(c["m"])(e).then((function(){t.$message({type:"success",message:"操作成功！"}),setTimeout((function(){location.reload()}),1e3)}))})).catch((function(){t.$message({type:"error",message:"操作失败！"})})):this.$confirm("即将开放下一轮次，本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，请确认。","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["m"])().then((function(){t.$message({type:"success",message:"操作成功！"}),setTimeout((function(){location.reload()}),1e3)}))})).catch((function(){t.$message({type:"error",message:"操作失败！"})}))},closeJudge:function(){var t=this;this.$confirm("即将关闭线上评审，本轮次还未提交评审结果的评委的剩余票数将不计入总票数内。此操作不可逆，确认？","",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["m"])().then((function(){t.$message({type:"success",message:"操作成功！"}),setTimeout((function(){location.reload()}),1e3)}))})).catch((function(){t.$message({type:"error",message:"操作失败！"})}))},getData:function(){var t=this,e={page:this.page,num:this.num};Object(c["h"])(e).then((function(e){t.promotionNum=e.data.total,t.promotedNum=e.data.promoted_num-e.data.total;var n=e.data.promotion_info;n.forEach((function(e){var n;t.votedWorks.includes(e.user_id)?e.checked=!0:e.checked=!1,""===e.work_name&&(e.work_name="测试"),(null===(n=!e.img_list)||void 0===n||n)&&(e.img_list=["https://ivillages-images.oss-cn-qingdao.aliyuncs.com/1/static/imgs/test.png"])})),t.promotionInfo=n}))}}},p=h,m=(n("8a6f"),Object(d["a"])(p,o,i,!1,null,"14a3002a",null));e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-6809aa11.f96f510f.js.map